<% layout('layout') -%>
<!DOCTYPE html>
<html>
  <head>
    <title>stamp.fm</title>
    <link rel="icon" type="image/png" href="/img_samp.fm_logo copy.jpg"/>
    <link rel="stylesheet" type="text/css" href="/login.css">
    <link href='http://fonts.googleapis.com/css?family=Poiret+One' rel='stylesheet' type='text/css'>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
    </style>
  </head>

<body style="margin:0;">
  <header id="header">
      <a href="http://www.stamp.fm"><img src="/headerStamp.png"></a>
      <ul style="float:right">
      <li>
      <a href="#upload" style="text-decoration:none" class="nav">UPLOAD</a>
    </li>
    <li>
      <a href="#notReal" style="text-decoration:none" class="nav">AUDITION</a>
      </li>
      <li>
      <a href="#notReal" style="text-decoration:none" class="nav">BRACKET</a>
      </li>
      </ul>  
    </header>
<div class="blurb">
<p style="font-size: 50px" class="big">Music lovers worldwide, rejoice.<br>
   Discover or compete.<br>
</p>
<p style="font-size: 30px" class="small">We are the online music tournament.</p>

</div>    

<div class="login">
<center>
<div id = "login-container">
  <form method = "POST" id = "inputFields">
      <p style="font-size: 30px">Enter Stamp.fm</p>
      <p style="font-size: 25px"><a href = "/auth/facebook"><img src="/facebook.png"></a><br>
        or<br>
        Sign in with your Email</p><br>
      <input type = "text" name = "email" id="user-tf" placeholder="Email" class="user" required/><br><br>
      <input type = "password" name = "pass" id = "pass-tf" placeholder="Password" class="pass" required/><br><br>
      <input type = "submit" value = "Sign In!" style="float:left" id="signIn"><br><br>
      <label for = "remember" id = "remember" style="float:left"> Remember Me: </label>
      <input type = "checkbox" id = "rememberme" checked = "checked" style="float:left"><br><br>
  </form>
</div>

<div class = "btm-links">
  <a href="#forgot" id = "forgot-password" class="link" style="float:left"> Forgot your Password? </a><br>
  <a href = "/signup" id = "create-account" class="link" style="float:left"> Create an Account. </a>
</div>
</center>
</div>

<!-- Modal Window(s) -->

<div id="forgot" class="modalDialog_temp">
  <div>
    <a href="#close" title="Close" class="close">X</a>

    <center>
    <h5 style="color:white">Enter Email to Recover Password</h5>
    <div>
      <form method = "post" action = "/forgot" id = "forgotpass">
        <input type="text" class="enterEmail" placeholder="Email" name = "email"><br><br>
        <input type="submit" value="Recover Password" id = "recoverPass">
      </form>
    </div>
</center>
  </div>
</div>

<!-- End Modal Window(s) -->

<!-- Modal Window(s) -->

<div id="upload" class="modalDialog">
  <div>
    <a href="#close" title="Close" class="close">X</a>
    <center>
    <h5 style="color:white">You must be logged in to use this feature!</h5>
</center>
  </div>
</div>

<!-- End Modal Window(s) -->

<!-- Modal Window(s) -->
<div id="Error" class="modalDialog_temp">
  <div>
    <a href="#close" title="Close" class="close" id = "close">X</a>
    <center>
    <h5 style="color:white">Error: Username and Password Combination don't match</h5>
</center>
  </div>
</div>
<!-- End Modal Window(s) -->


<!-- Modal Window(s) -->

<div id="notReal" class="modalDialog_temp">
  <div>
    <a href="#close" title="Close" class="close">X</a>
    <center>
    <h3 style="color:white">This stage of the competition has not begun yet.<br><br>
    See you July 25th!</h3>

    <p style="color:white">Stay up to date by liking us on Facebook or following us on Twitter!</p>

    <ul>
      <li> <div class="fb-like" data-href="https://www.facebook.com/Stamp.fm?fref=ts" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" data-font="arial"></div></li>
      <li>  <div>
            <a href="https://twitter.com/stampfm" class="twitter-follow-button" data-show-count="false" data-lang="en"></a>
            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></div></li>
    </ul>          
    </center>
  </div>
</div>

<!-- End Modal Window(s) -->


<!-- Modal Window(s) -->
<div id="BadEmail" class="modalDialog_temp">
  <div>
    <a href="#close" title="Close" class="close" id = "close">X</a>
    <center>
    <h5 style="color:white">Please Enter a valid Email Address</h5>
</center>
  </div>
</div>
<!-- End Modal Window(s) -->

<!-- Modal Window(s) -->
<div id="UnFilled" class="modalDialog_temp">
  <div>
    <a href="#close" title="Close" class="close" id = "close">X</a>
    <center>
    <h5 style="color:white">Please Fill In All Required Fields</h5>
</center>
  </div>
</div>
<!-- End Modal Window(s) -->


<!-- Modal Window(s) -->
<div id="recoverError" class="modalDialog_temp">
  <div>
    <a href="#close" title="Close" class="close" id = "close">X</a>
    <center>
    <h5 style="color:white">There was an error. Please try again.</h5>
</center>
  </div>
</div>
<!-- End Modal Window(s) -->

<!-- Modal Window(s) -->
<div id="recoverSuccess" class="modalDialog_temp">
  <div>
    <a href="#close" title="Close" class="close" id = "close">X</a>
    <center>
    <h5 style="color:white">You will recieve a reset email shortly.</h5>
</center>
  </div>
</div>
<!-- End Modal Window(s) -->

<!-- FB Like Script-->
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<script>
  $(document).ready(function() {
    $("#inputFields").submit(function(e){
      return false;
    });
    $('#signIn').click(function(event){ 
     var email = $('input#user-tf').val();
     var password = $('input#pass-tf').val();
     var rememberme = $('input#rememberme').is(':checked');
     var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
     if(email == "" || password == ""){
      $('div#UnFilled').addClass("unhidden");
        $('a#close').click(function(){
        $('div#UnFilled').removeClass("unhidden");
      });
     }
      else if (!email.match(re)){
        $('div#BadEmail').addClass("unhidden");
        $('a#close').click(function(){
        $('div#BadEmail').removeClass("unhidden");
        });
      }
      else{
     $.ajax({ 
           url: '/login',
           type: 'POST',
           cache: false, 
           data: {email: email, password: password, rememberme: rememberme},
           success: function(data){
            if(data.error != null){
              $('div#Error').addClass("unhidden");
              $('a#close').click(function(){
                $('div#Error').removeClass("unhidden");
              })
            }
            if (typeof data.redirect == 'string'){
              window.location = data.redirect;
            }
           }
        })
      }
     });
    $('#forgotpass').submit(function(e){
      return false;
    });
    $('#recoverPass').click(function(event){
      var email = $('input.enterEmail').val();
      $.ajax({
        url: '/forgot',
        type: 'POST',
        cache: false,
        data: {email: email},
        success: function(data){
          if(data.msg != "ok"){
            $('div#recoverError').addClass("unhidden");
            $('a#close').click(function(){
              $('div#recoverError').removeClass("unhidden");
            })
          } else {
            $('div#recoverSuccess').addClass("unhidden");
            $('a#close').click(function(){
              $('div#recoverSuccess').removeClass("unhidden");
            })
          }
        }
      })
    })
  });
</script>
<!-- End FB Like Script -->
</body>
</html>